@model PresentationLayer.ViewModels.EmployeeViewModel

@{
    ViewData["Title"] = "Изменение сотрудника";

    Layout = "_CreateUpdateLayout";
    string title = "Изменение сотрудника";
    ViewBag.Title = title;
    ViewBag.ActionName = title + ":";
    ViewBag.ItemName = Model.EmployeeModel.Surname + Model.EmployeeModel.Name + Model.EmployeeModel.MiddleName;
    ViewBag.AspController = "Employees";
    ViewBag.AspAction = "Update";
    ViewBag.AcceptButtonName = "Сохранить изменения";
    ViewBag.AlertMessage = "Заполните все поля!";
    ViewBag.Scripts = new string[]
    {
        "/lib/js/alerts.js"
    };

    string[] dateParts = System.DateTime.Now.ToShortDateString().Replace(".", "-").Split('-');

    string minYear = (Convert.ToInt32(dateParts[2]) - 99).ToString();

    string maxDate = $"{dateParts[2]}-{dateParts[1]}-{dateParts[0]}";

    string minDate = $"{minYear}-{dateParts[1]}-{dateParts[0]}";

    string[] currentDateParams = Model.EmployeeModel.DateOfEmployment.ToShortDateString().Split('.');

    string currentDate = $"{currentDateParams[2]}-{currentDateParams[1]}-{currentDateParams[0]}";
}

<div class="form-group">
    <label asp-for="EmployeeModel.Surname" class="control-label">Фамилия</label>
    <input maxlength="50" required asp-for="EmployeeModel.Surname" value="@Model.EmployeeModel.Surname" class="form-control input-form select-form" />
    <input asp-for="EmployeeModel.Id.Identifier" value="@Model.EmployeeModel.Id.Identifier" style="display:none;" />
</div>
<div class="form-group">
    <label asp-for="EmployeeModel.Name" class="control-label">Имя</label>
    <input maxlength="20" required asp-for="EmployeeModel.Name" value="@Model.EmployeeModel.Name" class="form-control input-form select-form" />
</div>
<div class="form-group">
    <label asp-for="EmployeeModel.MiddleName" class="control-label">Отчество</label>
    <input maxlength="20" required asp-for="EmployeeModel.MiddleName" value="@Model.EmployeeModel.MiddleName" class="form-control input-form select-form" />
</div>
<div class="form-group">
    <label asp-for="EmployeeModel.Position.Id.Identifier" class="control-label">Должность</label>
    <select required asp-for="EmployeeModel.Position.Id.Identifier" class="form-control select-form">
        <option disabled="disabled" value="default">Выберите должность</option>
        @foreach (var positionItem in Model.PositionCollection)
        {
            if (positionItem.Id.Identifier == Model.EmployeeModel.Position.Id.Identifier)
            {
                <option selected="selected" value="@positionItem.Id.Identifier">@positionItem.Name</option>
            }
            else
            {
                <option value="@positionItem.Id.Identifier">@positionItem.Name</option>
            }
        }
    </select>
    <br />
    <a asp-controller="Positions" asp-action="Create" class="btn btn-info">Создать должность</a>
</div>
<div class="form-group">
    <label asp-for="EmployeeModel.Company.Id.Identifier" class="control-label">Место работы</label>
    <select required asp-for="EmployeeModel.Company.Id.Identifier" class="form-control select-form">
        <option disabled="disabled" value="default">Выберите место работы</option>
        @foreach (var companyItem in Model.CompanyCollection)
        {
            if (companyItem.Id.Identifier == Model.EmployeeModel.Company.Id.Identifier)
            {
                <option selected="selected" value="@companyItem.Id.Identifier">@companyItem.Name</option>
            }
            else
            {
                <option value="@companyItem.Id.Identifier">@companyItem.Name</option>
            }
        }
    </select>
    <br />
    <a asp-controller="Companies" asp-action="Create" class="btn btn-info">Создать компанию</a>
</div>
<div class="form-group">
    <label asp-for="EmployeeModel.DateOfEmployment" class="control-label">Дата найма сотрудника</label>
    <input asp-for="EmployeeModel.DateOfEmployment" type="date" max="@maxDate" min="@minDate" value="@currentDate" class="form-control select-form" />
</div>

